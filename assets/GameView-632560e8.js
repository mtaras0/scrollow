import{d as se,r as p,a as B,u as G,b as D,c as Y,o as r,e as _,f as m,g as S,t as R,h as e,i as x,j as T,w as f,p as ie,k as ce,_ as M,l as V,m as J,n as H,q as re,s as ue,v as O,x as I,F as de,y as pe,T as _e,z as ve,A as me,B as q}from"./index-4797f6f3.js";import{_ as he}from"./ButtonWide.vue_vue_type_style_index_0_lang-eecd8638.js";const z=se("state",()=>{const a=p(!1),l=p(!1),u=p(1),i=()=>{u.value++},s=p(0);return{isPopup:a,isNewHighscore:l,mainGameKey:u,mainGameKeyInc:i,endgameScore:s}}),L=a=>(ie("data-v-c62886af"),a=a(),ce(),a),ge={class:"backdrop"},fe={class:"panel"},ye={class:"paneltext"},Se={key:0,style:{"font-variation-settings":"'wght' 425"}},we=L(()=>m("br",null,null,-1)),ke={key:1,style:{"font-variation-settings":"'wght' 425"}},Te=L(()=>m("br",null,null,-1)),xe={style:{"font-size":"3em","line-height":"1.5em"}},Pe=L(()=>m("br",null,null,-1)),be={key:2,style:{"margin-bottom":"1.25em","font-variation-settings":"'wght' 425"}},Ce={style:{"font-variation-settings":"'wght' 550"}},Ie=B({__name:"Popup",setup(a){G(w=>({"3dcb2150":e(l).active.popupbackdrop,"0309a0d9":e(l).active.back,"0311e11f":e(l).active.text,"006b289a":e(l).active.popupshadow}));const l=D(),u=Y(),i=z(),s=p(!1);i.isNewHighscore&&(s.value=!0);const y=()=>{i.mainGameKey++,i.isPopup=!1};return(w,$)=>(r(),_("div",ge,[m("div",fe,[m("div",ye,[s.value?(r(),_("span",Se,[S("New"),we,S("highscore!")])):(r(),_("span",ke,"Score:")),Te,m("span",xe,R(e(i).endgameScore),1),S(),Pe,s.value?x("",!0):(r(),_("div",be,[S(" Highscore: "),m("span",Ce,R(e(u).highscore),1)]))]),T(he,{onClick:y},{default:f(()=>[S("Again")]),_:1})])]))}});const Be=M(Ie,[["__scopeId","data-v-c62886af"]]),Me={class:"tileContents"},$e={key:0},Ge={key:1,class:"startContent"},Ne=B({__name:"TileItem",props:{tileType:null,isPreview:{type:Boolean},score:null,timeout:null,playingState:null,tileAmount:null},emits:["startgameEvent"],setup(a,{emit:l}){const u=a;G(g=>({"63a16981":e(i).active.main[a.tileType],"44bd4231":String(e($))+"vh",bdf79e7a:a.tileAmount*.007,"08c88de6":e(i).active.buttontext}));const i=D();let s=p(100),y=1600/u.timeout,w=15;const $=V(()=>Math.max(w-1-u.tileAmount,0)*.533);return J(()=>{s.value=100;let g=setInterval(()=>{s.value-=y,u.isPreview||(s.value=0),s.value<=0&&(s.value=0,clearInterval(g))},16)}),(g,d)=>(r(),_("div",{class:H(["tileMain",{tileShapeBig:!a.isPreview,tileShapeSmall:a.isPreview}]),onClick:d[0]||(d[0]=()=>{l("startgameEvent")})},[m("div",{class:H(["differBackground",{tileShapeBig:!a.isPreview,tileShapeSmall:a.isPreview}])},[m("div",{class:H({tileShapeBig:!a.isPreview,tileShapeSmall:a.isPreview}),style:re(`background: linear-gradient(to left, ${e(i).active.back+"72"} 0% ${e(s)}%, rgba(255 255 255 / 0) ${e(s)}% 100%);`)},[m("div",Me,[a.isPreview?(r(),_("div",$e,R(a.score),1)):x("",!0),a.playingState===0?(r(),_("div",Ge,"Scrollow!")):x("",!0)])],6)],2)],2))}});const Ae=M(Ne,[["__scopeId","data-v-60e372d9"]]),He={class:"tileButton"},Re={class:"tileButtonContents"},Ve=B({__name:"ButtonTile",props:{tileType:null},setup(a){const l=a;G(s=>({c523b006:e(u).active.main[e(i)],"79a31589":e(u).active.buttontext}));const u=D();let i=0;return l.tileType!==void 0?i=l.tileType:i=Math.floor(Math.random()*5),(s,y)=>(r(),_("div",He,[m("div",Re,[ue(s.$slots,"default",{},void 0,!0)])]))}});const W=M(Ve,[["__scopeId","data-v-6f0ca189"]]),De={id:"tileStack"},ze={key:-3},Le={key:-2},Ee=B({__name:"Game",setup(a){G(n=>({"6a1a42cc":e(oe)}));const l=z(),u=Y(),i=ve(),s=(n,t)=>Math.floor(Math.random()*(t-n+1))+n,y=async n=>new Promise(t=>setTimeout(t,n));let w=5;function $(n){for(let t=n.length-1;t>0;t--){let o=Math.floor(Math.random()*(t+1));[n[t],n[o]]=[n[o],n[t]]}}let g=O([0,1,2,3,4]);$(g);let d=p(0),N=p(!1),P={type:s(0,w-1),key:0,placing:!0},b=p(1),E=1,c=O([{type:g[0],key:E++,placing:!1}]),F=2500,A=p(F),Q=.875,C=15,K=p(0),k=p(0),j=p(100/C);const U=(n,t)=>{c.splice(t,0,n)},X=n=>{let t=[],o=0;for(;o<c.length-n+1;){let v=1;for(;o+v<c.length&&c[o].type===c[o+v].type;)v++;v>=n&&t.push({place:o,amount:v}),o+=v}let h=0;if(t.length>0)for(let v=t.length-1;v>=0;v--)c.splice(t[v].place,t[v].amount),h+=t[v].amount;return h},Z=async n=>{let t=0,o=0;do await y(250),t=X(n),t>0&&(k.value+=t*Math.pow(2,o),u.points+=t*Math.pow(2,o),o++,j.value=100*c.length/C);while(t>0)},ee=async()=>{for(l.endgameScore=0,l.isNewHighscore=!1,d.value=1;d.value===1;)i.currentRoute.value.path==="/"?(P={type:s(0,w-1),key:E++,placing:!0},N.value=!0,await y(A.value),N.value=!1,P.placing=!1,U(P,b.value),j.value=100*c.length/C,await Z(3),K.value=Math.floor(k.value/10),A.value=F*Math.pow(Q,K.value),c.length>=C&&(d.value=2)):(d.value=0,console.log("aborted game"));i.currentRoute.value.path==="/"&&(k.value>u.highscore&&(l.isNewHighscore=!0,u.highscore=k.value),l.endgameScore=k.value,l.isPopup=!0)},te=()=>{d.value===0&&ee()};let ae=window.innerHeight/100;const ne=()=>{let n=window.scrollY/ae,t=15+Math.max(C-1-c.length,0)*.5,o=Math.round(n/t);o>c.length&&(o=c.length),b.value=o},le=V(()=>N.value?b.value===0?[P].concat(c):c.slice(0,b.value).concat([P]).concat(c.slice(b.value)):c),oe=V(()=>d.value===0?"22vh":"41vh");return J(()=>{setInterval(ne,16)}),(n,t)=>{const o=me("RouterLink");return r(),_("div",De,[T(_e,{name:"transitionStack",tag:"ul"},{default:f(()=>[(r(),_("span",ze,[T(o,{to:"/tutorial",custom:""},{default:f(({navigate:h})=>[e(d)===0?(r(),I(W,{key:0,tileType:e(g)[3],onClick:h},{default:f(()=>[S(" How to ")]),_:2},1032,["tileType","onClick"])):x("",!0)]),_:1})])),(r(!0),_(de,null,pe(e(le),h=>(r(),I(Ae,{key:h.key,tileType:h.type,isPreview:h.placing,score:e(k),timeout:e(A),playingState:e(d),tileAmount:e(d)===0?e(c).length:e(c).length,onStartgameEvent:te},null,8,["tileType","isPreview","score","timeout","playingState","tileAmount"]))),128)),(r(),_("span",Le,[T(o,{to:"/palettes",custom:""},{default:f(({navigate:h})=>[e(d)===0?(r(),I(W,{key:0,tileType:e(g)[2],onClick:h},{default:f(()=>[S(" Palettes ")]),_:2},1032,["tileType","onClick"])):x("",!0)]),_:1})]))]),_:1})])}}});const Fe=M(Ee,[["__scopeId","data-v-dc6fd284"]]),Ke=B({__name:"GameView",setup(a){const l=z();return(u,i)=>(r(),_("div",null,[T(q,{name:"slide",mode:"out-in",appear:""},{default:f(()=>[(r(),I(Fe,{key:e(l).mainGameKey}))]),_:1}),T(q,{name:"slide",mode:"out-in",appear:""},{default:f(()=>[e(l).isPopup?(r(),I(Be,{key:0})):x("",!0)]),_:1})]))}});const qe=M(Ke,[["__scopeId","data-v-3312a712"]]);export{qe as default};
